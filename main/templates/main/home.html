{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>í™ˆ | RunningX</title>

  <style>
    body {
      margin: 0;
      font-family: "Pretendard", system-ui, sans-serif;
      overflow: hidden;
      height: 100dvh;
      display: flex;
    }

    /* ğŸŸ© ê°€ë¦¼ë§‰ */
    #splash {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: black;
      z-index: 9999;
      opacity: 1;
      transition: opacity 1s ease;
    }
    #splash.hidden { opacity: 0; pointer-events: none; }

/* ğŸŸ¦ ì¢Œìš° ë¶„í•  (110ë„ ê¸°ìš¸ê¸° + ê¸°ìš¸ì–´ì§„ ë°˜íˆ¬ëª… ë¼ì¸) */
.video-side {
  flex: none;
  width: 43%;
  background: black;
  position: relative;
  overflow: hidden;
  /* ì™¼ìª½ì´ ìœ„ë¡œ ì˜¬ë¼ê°€ëŠ” ëŒ€ê°ì„  (110ë„ ë°©í–¥ì— ëŒ€ì‘) */
  clip-path: polygon(0 0, 100% 0, calc(100% - 80px) 100%, 0 100%);
}

.content-side {
  flex: none;
  width: 57%;
  background: white;
  color: black;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: flex-start;
  padding-left: 80px;
  position: relative;
  transition: opacity 0.5s ease, transform 0.5s ease;
  /* ì˜¤ë¥¸ìª½ ì˜ì—­ë„ ëŒ€ì¹­ í´ë¦¬í•‘ */
  clip-path: polygon(80px 0, 100% 0, 100% 100%, 0 100%);
}

    /* ğŸ¬ ì˜ìƒ */
    video {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: opacity 1s ease-in-out;
      opacity: 1;
    }

    /* ğŸƒ ë¡œê³  + ìºì¹˜í”„ë ˆì´ì¦ˆ */
    .logo {
      position: absolute;
      top: 5px;
      left: 30px;
      width: 480px;
      opacity: 0;
      animation: fadeInDown 1.2s ease forwards;
      animation-delay: 0.8s;
    }

    .catch {
      position: absolute;
      top: 75px;
      left: 80px;
      width: 420px;
      opacity: 0;
      animation: fadeInDown 1.2s ease forwards;
      animation-delay: 1s;
    }

    /* ğŸ“± ëª¨ë°”ì¼ ì „ìš© ë¡œê³  */
    .mobile-unite {
      display: none;
      position: static;
      width: 240px;
      margin: 20px auto 10px auto;
      opacity: 0;
      animation: fadeInDown 1.2s ease forwards;
      animation-delay: 0.8s;
    }

    /* ğŸ§ ì¸ì‚¬ ë¬¸êµ¬ */
    h2 {
      font-size: 22px;
      font-weight: 600;
      margin-top: 100px;
      margin-bottom: 20px;
      opacity: 0;
      animation: fadeInDown 1s ease forwards;
      animation-delay: 1.2s;
    }

    /* ğŸ”² ë²„íŠ¼ ê·¸ë¦¬ë“œ */
    .button-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-gap: 10px;
      width: 80%;
      max-width: 700px;
      opacity: 0;
      animation: fadeInUp 1.2s ease forwards;
      animation-delay: 1.4s;
    }

    .button-grid form {
      margin: 0;
      width: 100%;
    }

    /* ë²„íŠ¼ ê³µí†µ ìŠ¤íƒ€ì¼ */
    .button-grid button,
    .button-grid a {
      border: none;
      font-weight: 600;
      font-size: 20px;
      padding: 50px 0px;
      border-radius: 0px;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      text-decoration: none;
      clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
    }

    .button-grid img {
      width: 24px;
      height: 24px;
      margin-top: 2px;
      margin-right: 60px;
      transform: scale(3.5);
      transform-origin: center;
    }

    /* ë²„íŠ¼ ìƒ‰ìƒ */
    .btn-route { background: #d9d9d9; color: #000; }
    .btn-profile { background: #888888; color: white; }
    .btn-logout { background: #555; color: white; }
    .btn-credit { background: #e5e5e5; color: #000; }

    .button-grid button:hover,
    .button-grid a:hover {
      filter: brightness(0.9);
    }

    /* ì• ë‹ˆë©”ì´ì…˜ */
    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* fade-out class */
    .fade-out {
      opacity: 0 !important;
      transform: translateX(-30px) !important;
      transition: opacity 0.5s ease, transform 0.5s ease;
      pointer-events: none;
    }

/* âœ… ëª¨ë°”ì¼ ëŒ€ì‘ */
@media (max-width: 900px) {
  body {
    flex-direction: column;
    height: auto;
    overflow: visible;
  }

  /* ğŸ¬ ì˜ìƒ ì˜ì—­ ì™„ì „íˆ ìˆ¨ê¸°ê¸° (ëŒ€ê°ì„  í¬í•¨) */
  .video-side,
  .video-side::after {
    display: none !important;
    clip-path: none !important;
  }

  /* ğŸƒ ì½˜í…ì¸  ì˜ì—­ 100% í™•ì¥ + ëŒ€ê°ì„  ì œê±° */
  .content-side {
    width: 100% !important;
    height: auto;
    align-items: center;
    justify-content: flex-start;
    padding: 20px;
    clip-path: none !important;
  }

  /* ë°ìŠ¤í¬í†±ìš© ë¡œê³  & ìºì¹˜í”„ë ˆì´ì¦ˆ ìˆ¨ê¸°ê¸° */
  .logo,
  .catch {
    display: none;
  }

  /* ëª¨ë°”ì¼ ì „ìš© ë¡œê³  í‘œì‹œ */
  .mobile-unite {
    display: block;
  }

  /* ì¸ì‚¬ ë¬¸êµ¬ ì¤‘ì•™ ì •ë ¬ */
  h2 {
    margin-top: 10px;
    text-align: center;
  }

  /* ë²„íŠ¼ì€ ë‹¨ì¼ ì»¬ëŸ¼ìœ¼ë¡œ */
  .button-grid {
    grid-template-columns: 1fr;
    width: 90%;
    max-width: 500px;
  }
}
  </style>
</head>

<body>
  <div id="splash"></div>

  <!-- ğŸ¬ ì¢Œì¸¡ ì˜ìƒ -->
  <div class="video-side">
    <video id="runnerVideo" autoplay muted playsinline>
      <source src="{% static 'main/videos/runnervideo.mp4' %}" type="video/mp4">
    </video>
  </div>

  <!-- ğŸƒ ìš°ì¸¡ ì½˜í…ì¸  -->
  <div class="content-side" id="contentSide">
    <!-- ë°ìŠ¤í¬í†±ìš© ë¡œê³  -->
    <img src="{% static 'main/images/logo.png' %}" alt="RunningX Logo" class="logo">
    <img src="{% static 'main/images/catch.png' %}" alt="Catchphrase" class="catch">
    <!-- ëª¨ë°”ì¼ìš© ë¡œê³  -->
    <img src="{% static 'main/images/unite.png' %}" alt="RunningX Unite" class="mobile-unite">

    <h2>ì•ˆë…•í•˜ì„¸ìš” {{ profile.user.username }}ë‹˜!</h2>

    {% if error_message %}
      <p style="color:red;">{{ error_message }}</p>
    {% endif %}

    <div class="button-grid">
      <form action="{% url 'main:home' %}" method="post">
        {% csrf_token %}
        <button type="submit" class="btn-route fade-link">
          ã…¤ê²½ë¡œ ì¶”ì²œë°›ê¸°
          <img src="{% static 'main/images/buttonicon1.png' %}" alt="ì•„ì´ì½˜">
        </button>
      </form>
      <a href="{% url 'main:profile' %}" class="btn-profile fade-link">
        ã…¤íšŒì› ì •ë³´ ìˆ˜ì •
        <img src="{% static 'main/images/buttonicon2.png' %}" alt="ì•„ì´ì½˜">
      </a>
      <a href="{% url 'main:logout' %}" class="btn-logout fade-link">
        ã…¤ë¡œê·¸ì•„ì›ƒ
        <img src="{% static 'main/images/buttonicon3.png' %}" alt="ì•„ì´ì½˜">
      </a>
      <a href="{% url 'main:developers' %}" class="btn-credit fade-link">
        ã…¤ë§Œë“  ì´ë“¤
        <img src="{% static 'main/images/buttonicon4.png' %}" alt="ì•„ì´ì½˜">
      </a>
    </div>
  </div>

  <script>
    // ğŸŸ© ê°€ë¦¼ë§‰ í˜ì´ë“œì•„ì›ƒ
    const splash = document.getElementById('splash');
    window.addEventListener('load', () => {
      setTimeout(() => splash.classList.add('hidden'), 500);
      setTimeout(() => splash.remove(), 1500);
    });

    // ğŸ¬ ì˜ìƒ ìì—°ìŠ¤ëŸ¬ìš´ ë°˜ë³µ
    const video = document.getElementById('runnerVideo');
    const FADE_TIME = 800;
    video.addEventListener('timeupdate', () => {
      if (video.duration - video.currentTime <= 1) {
        video.style.transition = `opacity ${FADE_TIME}ms ease-in-out`;
        video.style.opacity = '0';
      }
    });
    video.addEventListener('ended', () => {
      video.currentTime = 0.01;
      video.play();
      setTimeout(() => { video.style.opacity = '1'; }, 200);
    });

    // ë²„íŠ¼ í´ë¦­ ì‹œ ì½˜í…ì¸  fade-out í›„ í˜ì´ì§€ ì´ë™
    const contentSide = document.getElementById('contentSide');
    const fadeLinks = document.querySelectorAll('.fade-link');

    fadeLinks.forEach(link => {
      link.addEventListener('click', function(e){
        e.preventDefault();
        contentSide.classList.add('fade-out');

        setTimeout(() => {
          // ë²„íŠ¼ì´ form ë‚´ë¶€ì´ë©´ form.submit()
          const form = this.closest('form');
          if (form) {
            form.submit();
          } else {
            // a ë§í¬ ì´ë™
            const href = this.getAttribute('href');
            if (href) window.location.href = href;
          }
        }, 500); // fade-out ì‹œê°„
      });
    });
  </script>
</body>
</html>
